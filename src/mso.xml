<?xml version="1.0" encoding="UTF-8"?>
<mso xmlns='http://www.example.org/mso' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
	xsi:schemaLocation='http://www.example.org/mso mso.xsd'>
	<const name="RT_CurrentUserAtom" value="0x0FF6" />
	<struct name="RecordHeader">
		<uint4 name="recVer" />
		<uint12 name="recInstance" />
		<uint16 name="recType">
			<!--
					this limitation helps debugging
				-->
			<limitation expression="&gt;0" />
		</uint16>
		<uint32 name="recLen" />
	</struct>
	<struct name="CurrentUserAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0x0FF6" />
			<!--
				valueRef="RT_CurrentUserAtom" />
			-->
		</type>
		<uint32 name="size">
			<limitation value="0x14" />
		</uint32>
		<uint32 name="headerToken">
			<limitation value="0xE391C05F|0xF3D1C4DF" />
		</uint32>
		<uint32 name="offsetToCurrentEdit" />
		<uint16 name="lenUserName">
			<limitation expression="&lt;=255" />
		</uint16>
		<uint16 name="docFileVersion">
			<limitation value="0x03F4" />
		</uint16>
		<uint8 name="majorVersion">
			<limitation value="0x03" />
		</uint8>
		<uint8 name="minorVersion">
			<limitation value="0x00" />
		</uint8>
		<uint16 name="unused" />
		<uint8 name="ansiUserName" count="lenUserName" />
		<uint32 name="relVersion">
			<limitation value="0x8|0x9" />
		</uint32>
		<uint8 name="unicodeUserName" count="2*lenUserName"
			condition="rh.recLen==3*lenUserName+0x14" />
	</struct>
	<struct name="CurrentUserStream">
		<type name="anon1" type="CurrentUserAtom" />
	</struct>
	<struct name="PicturesStream">
		<type name="anon1" type="OfficeArtBStoreDelay" />
	</struct>
	<struct name="OfficeArtBStoreDelay">
		<type name="anon1" array="true" type="OfficeArtBStoreContainerFileBlock" />
	</struct>
	<struct name="OfficeArtRecordHeader">
		<uint4 name="recVer" />
		<uint12 name="recInstance" />
		<uint16 name="recType" />
		<uint32 name="recLen" />
	</struct>
	<struct name="OfficeArtFBSE">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0x2" />
			<limitation name="recInstance" value="0|1|2|3|4|5|6|7|0x11|0x12" />
			<!--
				<limitation name="recInstance"
				value="0xF01A|0xF01B|0xF01C|0xF01D|0xF01E|0xF01F|0xF029" />
			-->
			<limitation name="recType" value="0xF007" />
		</type>
		<uint8 name="btWin32" />
		<uint8 name="btMacOS" />
		<uint8 name="rgbUid" array="true" count="16" />
		<uint16 name="tag" />
		<uint32 name="size">
			<limitation expression="&gt;=8" />
		</uint32>
		<uint32 name="cRef" />
		<uint32 name="foDelay" />
		<uint8 name="unused1" />
		<uint8 name="cbName" />
		<uint8 name="unused2" />
		<uint8 name="unused3" />
		<uint8 name="nameData" array="true" count="cbName" />
		<type name="embeddedBlip" type="OfficeArtBlip" condition="rh.recLen > 36 + cbName">
			<!--
				this limitation is currently not supported because it requires
				dynamic introspection <limitation name="rh.recInstance"
				value="rh.recInstance" />
			-->
		</type>
	</struct>
	<struct name="OfficeArtBlipEMF">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0x3D4|0x3D5" />
			<limitation name="recType" value="0xF01A" />
		</type>
		<uint8 name="rgbUid1" array="true" count="16" />
		<uint8 name="rgbUid2" array="true" count="16"
			condition="rh.recInstance == 0x3D5" />
		<type name="metafileHeader" type="OfficeArtMetafileHeader" />
		<uint8 name="BLIPFileData" array="true"
			count="rh.recLen-((rh.recInstance==0x3D4)?50:66)" />
	</struct>
	<struct name="OfficeArtBlipWMF">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0x216|0x217" />
			<limitation name="recType" value="0xF01B" />
		</type>
		<uint8 name="rgbUid1" array="true" count="16" />
		<uint8 name="rgbUid2" array="true" count="16"
			condition="rh.recInstance == 0x217" />
		<type name="metafileHeader" type="OfficeArtMetafileHeader" />
		<uint8 name="BLIPFileData" array="true"
			count="rh.recLen-((rh.recInstance==0x216)?50:66)" />
	</struct>
	<struct name="OfficeArtBlipPICT">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0x542|0x543" />
			<limitation name="recType" value="0xF01C" />
		</type>
		<uint8 name="rgbUid1" array="true" count="16" />
		<uint8 name="rgbUid2" array="true" count="16"
			condition="rh.recInstance == 0x543" />
		<type name="metafileHeader" type="OfficeArtMetafileHeader" />
		<uint8 name="BLIPFileData" array="true"
			count="rh.recLen-((rh.recInstance==0x542)?50:66)" />
	</struct>
	<struct name="OfficeArtBlipJPEG">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0x46A|0x46B|0x6E2|0x6E3" />
			<limitation name="recType" value="0xF01D" />
		</type>
		<uint8 name="rgbUid1" array="true" count="16" />
		<uint8 name="rgbUid2" array="true" count="16"
			condition="rh.recInstance == 0x46B || rh.recInstance == 0x6E3" />
		<uint8 name="tag" />
		<uint8 name="BLIPFileData" array="true"
			count="rh.recLen-((rh.recInstance == 0x46A || rh.recInstance == 0x6E2)?17:33)" />
	</struct>
	<struct name="OfficeArtBlipPNG">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0x6E0|0x6E1" />
			<limitation name="recType" value="0xF01E" />
		</type>
		<uint8 name="rgbUid1" array="true" count="16" />
		<uint8 name="rgbUid2" array="true" count="16"
			condition="rh.recInstance == 0x6E1" />
		<uint8 name="tag" />
		<uint8 name="BLIPFileData" array="true"
			count="rh.recLen-((rh.recInstance==0x6E0)?17:33)" />
	</struct>
	<struct name="OfficeArtBlipDIB">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0x7A8|0x7A9" />
			<limitation name="recType" value="0xF01F" />
		</type>
		<uint8 name="rgbUid1" array="true" count="16" />
		<uint8 name="rgbUid2" array="true" count="16"
			condition="rh.recInstance == 0x7A9" />
		<uint8 name="tag" />
		<uint8 name="BLIPFileData" array="true"
			count="rh.recLen-((rh.recInstance==0x7A8)?17:33)" />
	</struct>
	<struct name="OfficeArtBlipTIFF">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0x6E4|0x6E5" />
			<limitation name="recType" value="0xF020" />
		</type>
		<uint8 name="rgbUid1" array="true" count="16" />
		<uint8 name="rgbUid2" array="true" count="16"
			condition="rh.recInstance == 0x6E5" />
		<uint8 name="tag" />
		<uint8 name="BLIPFileData" array="true"
			count="rh.recLen-((rh.recInstance==0x6E4)?17:33)" />
	</struct>
	<struct name="OfficeArtMetafileHeader">
		<uint32 name="cbSize" />
		<type name="rcBounds" type="RECT" />
		<type name="ptSize" type="POINT" />
		<uint32 name="cbsave" />
		<uint8 name="compression" />
		<uint8 name="filter" />
	</struct>
	<struct name="RECT">
		<int32 name="left" />
		<int32 name="top" />
		<int32 name="right" />
		<int32 name="bottom" />
	</struct>
	<struct name="POINT">
		<int32 name="x" />
		<int32 name="y" />
	</struct>
	<struct name="OfficeArtBlip">
		<choice name="anon">
			<type type="OfficeArtBlipEMF" />
			<type type="OfficeArtBlipWMF" />
			<type type="OfficeArtBlipPICT" />
			<type type="OfficeArtBlipJPEG" />
			<type type="OfficeArtBlipPNG" />
			<type type="OfficeArtBlipDIB" />
			<type type="OfficeArtBlipTIFF" />
		</choice>
	</struct>
	<struct name="OfficeArtBStoreContainerFileBlock">
		<choice name="anon">
			<type type="OfficeArtFBSE" />
			<type type="OfficeArtBlip" />
		</choice>
	</struct>
	<struct name="PowerPointStructs">
		<type name="anon" type="PowerPointStruct" array="true" />
	</struct>
	<struct name="PowerPointStruct">
		<choice name="anon">
			<type type="DocumentContainer" />
			<type type="MasterOrSlideContainer" />
			<!-- <type type="TODO" /> -->
		</choice>
	</struct>
	<struct name="DocumentContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x03E8" />
		</type>
		<type name="documentAtom" type="DocumentAtom" />
		<type name="exObjList" type="ExObjListContainer" optional="true" />

		<type name="documentTextInfo" type="DocumentTextInfoContainer" />
		<!-- TODO name="soundCollection" -->
		<type name="drawingGroup" type="DrawingGroupContainer" />
		<type name="masterList" type="MasterListWithTextContainer" />
		<type name="slideList" type="SlideListWithTextContainer"
			optional="true" />
	</struct>
	<struct name="MasterListWithTextContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x1" />
			<limitation name="recType" value="0x0FF0" />
			<limitation name="recLen" expression="%28==0" />
		</type>
		<type name="rgMasterPersistAtom" type="MasterPersistAtom" count="rh.recLen/28" />
	</struct>
	<struct name="MasterPersistAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0x3F3" />
			<limitation name="recLen" value="0x14" />
		</type>
		<type name="persistIdRef" type="PersistIdRef" />
		<uint2 name="reserved1">
			<limitation value="0" />
		</uint2>
		<bit name="fNonOutLineData" />
		<uint5 name="reserved2">
			<limitation value="0" />
		</uint5>
		<uint8 name="reserved3">
			<limitation value="0" />
		</uint8>
		<uint16 name="reserved4">
			<limitation value="0" />
		</uint16>
		<uint32 name="reserved5">
			<limitation value="0" />
		</uint32>
		<uint32 name="masterId" />
		<uint32 name="reserved6">
			<limitation value="0" />
		</uint32>
	</struct>
	<struct name="SlideListWithTextContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FF0" />
		</type>
		<type name="rgChildRec" type="SlideListWithTextSubContainerOrAtom"
			array="true" />
	</struct>
	<struct name="SlideListWithTextSubContainerOrAtom">
		<!--  we ignore the details of the order of slides required here -->
		<choice name="anon">
			<type type="SlidePersistAtom" />
			<type type="TextHeaderAtom" />
			<type type="TextCharsAtom" />
			<type type="TextBytesAtom" />
			<type type="StyleTextPropAtom" />
			<type type="SlideNumberMCAtom" />
			<type type="DateTimeMCAtom" />
			<type type="GenericDateMCAtom" />
			<type type="HeaderMCAtom" />
			<type type="FooterMCAtom" />
			<type type="RTFDateTimeMCAtom" />
			<type type="TextBookmarkAtom" />
			<type type="TextSpecialInfoAtom" />
			<type type="InteractiveInfoInstance" />
			<type type="TextInteractiveInfoInstance" />
		</choice>
	</struct>
	<struct name="SlidePersistAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0x3F3" />
			<limitation name="recLen" value="0x14" />
		</type>
		<type name="persistIdRef" type="PersistIdRef" />
		<bit name="reserved1">
			<limitation value="false" />
		</bit>
		<bit name="fShouldCollapse" />
		<bit name="fNonOutlineData" />
		<uint5 name="reserved2">
			<limitation value="0" />
		</uint5>
		<uint8 name="reserved3">
			<limitation value="0" />
		</uint8>
		<uint16 name="reserved4">
			<limitation value="0" />
		</uint16>
		<int32 name="cTexts">
			<limitation expression="&gt;=0" />
			<limitation expression="&lt;=8" />
		</int32>
		<type name="slideId" type="SlideId" />
		<uint32 name="reserved5">
			<limitation value="0" />
		</uint32>
	</struct>
	<struct name="TextHeaderAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0|1|2|3|4|5" />
			<limitation name="recType" value="0xF9F" />
			<limitation name="recLen" value="4" />
		</type>
		<uint32 name="textType" />
	</struct>
	<struct name="TextCharsAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFA0" />
			<limitation name="recLen" expression="%2==0" />
		</type>
		<uint16 name="textChars" count="rh.recLen/2">
			<limitation value="!0" />
		</uint16>
	</struct>
	<struct name="TextBytesAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFA8" />
		</type>
		<uint8 name="textChars" count="rh.recLen">
			<limitation value="!0" />
		</uint8>
	</struct>
	<struct name="StyleTextPropAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFA0" />
		</type>
		<!-- this one seems very hard to do -->
		<uint8 name="wrong" count="rh.recLen" />
	</struct>
	<struct name="SlideNumberMCAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFD8" />
			<limitation name="recLen" value="4" />
		</type>
		<int32 name="position" />
	</struct>
	<struct name="DateTimeMCAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFF7" />
			<limitation name="recLen" value="8" />
		</type>
		<int32 name="position" />
		<uint8 name="index" />
		<uint8 name="unused" count="3" />
	</struct>
	<struct name="GenericDateMCAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFF8" />
			<limitation name="recLen" value="4" />
		</type>
		<int32 name="position" />
	</struct>
	<struct name="HeaderMCAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFF9" />
			<limitation name="recLen" value="4" />
		</type>
		<int32 name="position" />
	</struct>
	<struct name="FooterMCAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFFA" />
			<limitation name="recLen" value="4" />
		</type>
		<int32 name="position" />
	</struct>
	<struct name="RTFDateTimeMCAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0x1015" />
			<limitation name="recLen" value="0x84" />
		</type>
		<int32 name="position" />
		<uint8 name="format" count="128" />
	</struct>
	<struct name="TextBookmarkAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFA7" />
			<limitation name="recLen" value="0xC" />
		</type>
		<int32 name="begin" />
		<int32 name="end">
			<!--
				TODO: figure out how to do this <limitation expression="&gt; begin"
				/> <limitation expression="&lt;= begin+255" />
			-->
		</int32>
		<int32 name="bookmarkID" />
	</struct>
	<struct name="TextSpecialInfoAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFAA" />
		</type>
		<!-- this one seems impossible to do -->
		<uint8 name="wrong" count="rh.recLen" />
	</struct>
	<struct name="InteractiveInfoInstance">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0|1" />
			<limitation name="recType" value="0xFF2" />
			<limitation name="recLen" value="8" />
		</type>
		<!-- TODO either mouseover or mouseclick -->
		<uint8 name="range" count="8" />
	</struct>
	<struct name="TextInteractiveInfoInstance">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0" />
			<limitation name="recType" value="0xFDF" />
			<limitation name="recLen" value="8" />
		</type>
		<!-- TODO either mouseover or mouseclick -->
		<uint8 name="range" count="8" />
	</struct>
	<struct name="SlideId">
		<uint32 name="slideId">
			<limitation expression="&gt;=100" />
			<limitation expression="&lt;2147483647" />
		</uint32>
	</struct>
	<struct name="DocumentTextInfoContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x03F2" />
		</type>
		<type name="kinsoku" type="KinsokuContainer" optional="true" />
		<type name="fontCollection" type="FontCollectionContainer"
			optional="true" />
		<type name="textCFDefaultsAtom" type="TextCFExceptionAtom"
			optional="true" />
		<type name="textPFDefaultsAtom" type="TextPFExceptionAtom"
			optional="true" />
		<type name="defaultRulerAtom" type="DefaultRulerAtom" optional="true" />
		<type name="textSIDefaultsAtom" type="TextSIExceptionAtom" />
		<type name="textMasterStyleAtom" type="TextMasterStyleAtom" />
	</struct>
	<struct name="TextCFExceptionAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FA4" />
		</type>
		<type name="cf" type="TextCFException" />
	</struct>
	<struct name="DefaultRulerAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FAB" />
		</type>
		<type name="defaultTextRuler" type="TextRuler">
			<limitation name="fDefaultTabSize" value="true" />
			<limitation name="fCLevels" value="true" />
			<limitation name="fTabStops" value="true" />
			<limitation name="fLeftMargin1" value="true" />
			<limitation name="fLeftMargin2" value="true" />
			<limitation name="fLeftMargin3" value="true" />
			<limitation name="fLeftMargin4" value="true" />
			<limitation name="fIndent1" value="true" />
			<limitation name="fIndent2" value="true" />
			<limitation name="fIndent3" value="true" />
			<limitation name="fIndent4" value="true" />
			<limitation name="fIndent5" value="true" />
		</type>
	</struct>
	<struct name="TextRuler">
		<bit name="fDefaultTabSize" />
		<bit name="fCLevels" />
		<bit name="fTabStops" />
		<bit name="fLeftMargin1" />
		<bit name="fLeftMargin2" />
		<bit name="fLeftMargin3" />
		<bit name="fLeftMargin4" />
		<bit name="fLeftMargin5" />
		<bit name="fIndent1" />
		<bit name="fIndent2" />
		<bit name="fIndent3" />
		<bit name="fIndent4" />
		<bit name="fIndent5" />
		<uint3 name="reserved1" />
		<uint16 name="reserved2" />
		<int16 name="cLevels" condition="fCLevels" />
		<uint16 name="defaultTabSize" condition="fDefaultTabSize" />
		<type name="tabs" type="TabStops" condition="fTabStops" />
		<uint16 name="leftMargin1" condition="fLeftMargin1" />
		<uint16 name="indent1" condition="fIndent1" />
		<uint16 name="leftMargin2" condition="fLeftMargin2" />
		<uint16 name="indent2" condition="fIndent2" />
		<uint16 name="leftMargin3" condition="fLeftMargin3" />
		<uint16 name="indent3" condition="fIndent3" />
		<uint16 name="leftMargin4" condition="fLeftMargin4" />
		<uint16 name="indent4" condition="fIndent4" />
		<uint16 name="leftMargin5" condition="fLeftMargin5" />
		<uint16 name="indent5" condition="fIndent5" />
	</struct>
	<struct name="TabStops">
		<uint16 name="count" />
		<type name="rgTabStop" count="count" type="TabStop" />
	</struct>
	<struct name="TabStop">
		<int16 name="position" />
		<uint16 name="type" />
	</struct>
	<struct name="TextPFExceptionAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FA5" />
		</type>
		<uint16 name="reserved" />
		<type name="pf" type="TextPFException" />
	</struct>
	<struct name="TextPFException">
		<type name="masks" type="PFMasks">
			<!--
				it seems ppt files generated with OpenOffice Impress 3.0 can have
				bulletBlip = true
			-->
			<limitation name="bulletBlip" value="false" />
			<!--
				it seems ppt files generated with OpenOffice Impress 3.0 can have
				bulletHasScheme = true
			-->
			<limitation name="bulletHasScheme" value="false" />
			<!--
				it seems ppt files generated with OpenOffice Impress 3.0 can have
				bulletScheme = true
			-->
			<limitation name="bulletScheme" value="false" />
		</type>
		<type name="bulletFlags" type="BulletFlags"
			condition="masks.hasBullet||masks.bulletHasFont||masks.bulletHasColor||masks.bulletHasSize" />
		<int16 name="bulletChar" condition="masks.bulletChar">
			<limitation value="!0" />
		</int16>
		<uint16 name="bulletFontRef" condition="masks.bulletFont" />
		<uint16 name="bulletSize" condition="masks.bulletSize" />
		<uint32 name="bulletColor" condition="masks.bulletColor" />
		<uint16 name="textAlignment" condition="masks.align" />
		<uint16 name="lineSpacing" condition="masks.lineSpacing" />
		<uint16 name="spaceBefore" condition="masks.spaceBefore" />
		<uint16 name="spaceAfter" condition="masks.spaceAfter" />
		<uint16 name="leftMargin" condition="masks.leftMargin" />
		<uint16 name="indent" condition="masks.indent" />
		<uint16 name="defaultTabSize" condition="masks.defaultTabSize" />
		<type name="tabStops" type="TabStops" condition="masks.tabStops" />
		<uint16 name="fontAlign" condition="masks.fontAlign" />
		<uint16 name="wrapFlags" condition="masks.charWrap||masks.wordWrap||masks.overflow" />
		<uint16 name="textDirection" condition="masks.textDirection" />
	</struct>
	<struct name="BulletFlags">
		<bit name="fHasBullet" />
		<bit name="fBulletHasFont" />
		<bit name="fBulletHasColor" />
		<bit name="fBulletHasSize" />
		<uint12 name="reserved" />
	</struct>
	<struct name="PFMasks">
		<bit name="hasBullet" />
		<bit name="bulletHasFont" />
		<bit name="bulletHasColor" />
		<bit name="bulletHasSize" />
		<bit name="bulletFont" />
		<bit name="bulletColor" />
		<bit name="bulletSize" />
		<bit name="bulletChar" />
		<bit name="leftMargin" />
		<bit name="unused" />
		<bit name="indent" />
		<bit name="align" />
		<bit name="lineSpacing" />
		<bit name="spaceBefore" />
		<bit name="spaceAfter" />
		<bit name="defaultTabSize" />
		<bit name="fontAlign" />
		<bit name="charWrap" />
		<bit name="wordWrap" />
		<bit name="overflow" />
		<bit name="tabStops" />
		<bit name="textDirection" />
		<bit name="reserved" />
		<bit name="bulletBlip" />
		<bit name="bulletScheme" />
		<bit name="bulletHasScheme" />
		<uint6 name="reserved2" />
	</struct>
	<struct name="TextCFException">
		<type name="masks" type="CFMasks">
			<limitation name="pp10ext" value="false" />
			<limitation name="newEATypeface" value="false" />
			<limitation name="csTypeface" value="false" />
			<limitation name="pp11ext" value="false" />
		</type>
		<type name="fontStyle" type="CFStyle"
			condition="masks.bold || masks.italic || masks.underline || masks.shadow || masks.fehint || masks.kumi || masks.emboss || masks.fHasStyle != 0" />
		<uint16 name="fontRef" condition="masks.typeface" />
		<uint16 name="oldEAFontRef" condition="masks.oldEATypeface" />
		<uint16 name="ansiFontRef" condition="masks.ansiTypeface" />
		<uint16 name="symbolFontRef" condition="masks.symbolTypeface" />
		<uint16 name="fontSize" condition="masks.size">
			<limitation expression="&gt;=1" />
			<limitation expression="&lt;=4000" />
		</uint16>
		<uint32 name="color" condition="masks.color" />
		<uint16 name="position" condition="masks.position">
			<limitation expression="&gt;=-100" />
			<limitation expression="&lt;=100" />
		</uint16>
	</struct>
	<struct name="CFMasks">
		<bit name="bold" />
		<bit name="italic" />
		<bit name="underline" />
		<bit name="unused1" />
		<bit name="shadow" />
		<bit name="fehint" />
		<bit name="unused2" />
		<bit name="kumi" />
		<bit name="unused3" />
		<bit name="emboss" />
		<uint4 name="fHasStyle" />
		<uint2 name="unused4" />
		<bit name="typeface" />
		<bit name="size" />
		<bit name="color" />
		<bit name="position" />
		<bit name="pp10ext" />
		<bit name="oldEATypeface" />
		<bit name="ansiTypeface" />
		<bit name="symbolTypeface" />
		<bit name="newEATypeface" />
		<bit name="csTypeface" />
		<bit name="pp11ext" />
		<uint5 name="reserved" />
	</struct>
	<struct name="CFStyle">
		<bit name="bold" />
		<bit name="italic" />
		<bit name="underline" />
		<bit name="unused1" />
		<bit name="shadow" />
		<bit name="fehint" />
		<bit name="unused2" />
		<bit name="kumi" />
		<bit name="unused3" />
		<bit name="emboss" />
		<uint4 name="pp9rt" />
		<uint2 name="unused4" />
	</struct>
	<struct name="FontCollectionContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x07D5" />
		</type>
		<uint8 name="rgFontCollectionEntry" count="rh.recLen" />
		<!--
			TODO implement
		-->
	</struct>
	<struct name="KinsokuContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x2" />
			<limitation name="recType" value="0x0FC8" />
		</type>
		<type name="kinsokuAtom" type="KinsokuAtom" />
		<!--
			<type name="kinsokuLeadingAtom" type="KinsokuFollowingAtom"
			condition="kinsokuAtom.level=2" /> <type name="kinsokuFollowingAtom"
			type="KinsokuFollowingAtom" condition="kinsokuAtom.level=2" />
		-->
	</struct>
	<struct name="KinsokuAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x3" />
			<limitation name="recType" value="0x0FD2" />
			<limitation name="recLen" value="4" />
		</type>
		<uint32 name='level'>
			<limitation value="0|1|2" />
		</uint32>
	</struct>
	<struct name="TextSIExceptionAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FA9" />
		</type>
		<uint8 name="textSIException" count="rh.recLen" />
		<!--
			TODO implement
		-->
	</struct>
	<struct name="TextMasterStyleAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0|1|2|3|4|5|6|7|8" />
			<limitation name="recType" value="0x0FA3" />
		</type>
		<uint16 name="cLevels" />
		<!--
			level field of TextMasterStyleLevel is put here, because its presence
			depends on this structure and currently child access to parent
			properties is not supported
		-->
		<uint16 name="lstLvl1level" condition="rh.recInstance&gt;=5" />
		<type name="lstLvl1" type="TextMasterStyleLevel" condition="cLevels&gt;0" />
		<uint16 name="lstLvl2level" condition="rh.recInstance&gt;=5" />
		<type name="lstLvl2" type="TextMasterStyleLevel" condition="cLevels&gt;1" />
		<uint16 name="lstLvl3level" condition="rh.recInstance&gt;=5" />
		<type name="lstLvl3" type="TextMasterStyleLevel" condition="cLevels&gt;2" />
		<uint16 name="lstLvl4level" condition="rh.recInstance&gt;=5" />
		<type name="lstLvl4" type="TextMasterStyleLevel" condition="cLevels&gt;3" />
		<uint16 name="lstLvl5level" condition="rh.recInstance&gt;=5" />
		<type name="lstLvl5" type="TextMasterStyleLevel" condition="cLevels&gt;4" />
	</struct>
	<struct name="TextMasterStyleLevel">
		<type name="pf" type="TextPFException" />
		<type name="cf" type="TextCFException" />
	</struct>
	<struct name="ExOleEmbedAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FCD" />
			<limitation name="recLen" value="0x8" />
		</type>
		<uint32 name="exColorFollow">
			<limitation value="0|1|2" />
		</uint32>
		<uint8 name="fCantLockServer" />
		<uint8 name="fNoSizeToServer" />
		<uint8 name="fIsTable" />
		<uint8 name="unused" />
	</struct>
	<struct name="DocumentAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="1" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x03E9" />
			<limitation name="recLen" value="0x28" />
		</type>
		<type name="slideSize" type="PointStruct" />
		<type name="notesSize" type="PointStruct" />
		<type name="serverZoom" type="RatioStruct">
			<limitation expression="numer*denom &gt; 0" />
		</type>
		<type name="notesMasterPersistIdRef" type="PersistIdRef" />
		<type name="handoutMasterPersistIdRef" type="PersistIdRef" />
		<uint16 name="firstSlideNumber">
			<limitation expression="&lt;10000" />
		</uint16>
		<uint16 name="slideSizeType">
			<limitation value="0|1|2|3|4|5|6" />
		</uint16>
		<uint8 name="fSaveWithFonts" />
		<uint8 name="fOmitTitlePlace" />
		<uint8 name="fRightToLeft" />
		<uint8 name="fShowComments" />
	</struct>
	<struct name="PointStruct">
		<int32 name="x" />
		<int32 name="y" />
	</struct>
	<struct name="RatioStruct">
		<int32 name="numer" />
		<int32 name="denom">
			<limitation expression="!= 0" />
		</int32>
	</struct>
	<struct name="PersistIdRef">
		<uint32 name="anon">
			<!--
				TODO A 4-byte unsigned integer that specifies a reference to a
				persist object. It MUST be 0x00000000 or equal to a persist object
				identifier specified by a PersistDirectoryAtom record. The value
				0x00000000 specifies a null reference.
			-->
		</uint32>
	</struct>
	<struct name="MasterOrSlideContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x03EE|0x03F8" />
		</type>
	</struct>
	<struct name="ExObjListContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0409" />
			<limitation name="recLen" expression="&gt;=12" />
		</type>
		<type name="exObjListAtom" type="ExObjListAtom" />
		<type name="rgChildRec" type="ExObjListSubContainer" count="rh.recLen-12" />
	</struct>
	<struct name="ExObjListAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x040A" />
			<limitation name="recLen" value="4" />
		</type>
		<int32 name="exObjIdSeed">
			<limitation expression="&gt;1" />
			<!--
				TODO:exObjIdSeed (4 bytes): A signed integer that specifies a seed
				for creating a new ExObjId or ExHyperlinkId value. It MUST be
				greater than or equal to the largest ExObjId value in the file as
				specified by the ExMediaAtom record or ExOleObjAtom record and MUST
				be greater than or equal to the largest ExHyperlinkId value in the
				file as specified by the ExHyperlinkAtom record. It MUST be greater
				than or equal to 0x00000001.
			-->
		</int32>
	</struct>
	<struct name="ExObjListSubContainer">
		<choice name="anon">
			<type name="anon" type="ExOleLinkContainer" />
			<type name="anon" type="ExOleEmbedContainer" />
			<!-- TODO: finish by adding the missing options-->
		</choice>
	</struct>
	<struct name="ExOleLinkContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FCE" />
		</type>
		<type name="exOleLinkAtom" type="ExOleLinkAtom" />
		<type name="exOleObjAtom" type="ExOleObjAtom" />
		<type name="menuNameAtom" type="MenuNameAtom" optional="true" />
		<type name="progIdAtom" type="ProgIDAtom" optional="true" />
		<type name="clipboardNameAtom" type="ClipboardNameAtom" optional="true" />
		<type name="metafile" type="MetafileBlob" optional="true" />
	</struct>
	<struct name="ExOleEmbedContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FCC" />
		</type>
		<type name="exOleEmbedAtom" type="ExOleEmbedAtom" />
		<type name="exOleObjAtom" type="ExOleObjAtom" />
		<type name="menuNameAtom" type="MenuNameAtom" optional="true" />
		<type name="progIdAtom" type="ProgIDAtom" optional="true" />
		<type name="clipboardNameAtom" type="ClipboardNameAtom" optional="true" />
		<type name="metafile" type="MetafileBlob" optional="true" />
	</struct>
	<struct name="ExOleLinkAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FD1" />
			<limitation name="recType" value="0xC" />
		</type>
		<uint32 name="slideIdRef">
			<!--
				A 4-byte unsigned integer that specifies a reference to a
				presentation slide. It MUST be 0x00000000 or equal to the value of
				the slideId field of a SlidePersistAtom record. The value 0x00000000
				specifies a null reference.
			-->
		</uint32>
		<uint32 name="oleUpdateMode" />
		<uint32 name="unused" />
	</struct>
	<struct name="ExOleObjAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x1" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FC3" />
			<limitation name="recLen" value="0x18" />
		</type>
		<uint32 name="drawAspect" />
		<uint32 name="type" />
		<uint32 name="exObjId" />
		<uint32 name="subType" />
		<uint32 name="persistIdRef" />
		<uint32 name="unused" />
	</struct>
	<struct name="MenuNameAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x1" />
			<limitation name="recType" value="0x0FBA" />
			<limitation name="recLen" expression="%2 == 0 " />
		</type>
		<uint8 name="menuName" count="rh.recLen" />
	</struct>
	<struct name="ProgIDAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x2" />
			<limitation name="recType" value="0x0FBA" />
			<limitation name="recLen" expression="%2 == 0 " />
		</type>
		<uint8 name="progId" count="rh.recLen" />
	</struct>
	<struct name="ClipboardNameAtom">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x3" />
			<limitation name="recType" value="0x0FBA" />
			<limitation name="recLen" expression="%2 == 0 " />
		</type>
		<uint8 name="clipboardName" count="rh.recLen" />
	</struct>
	<struct name="MetafileBlob">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0FC1" />
			<limitation name="recLen" expression="&gt;16" />
		</type>
		<int16 name="mm" />
		<int16 name="xExt" />
		<int16 name="yExt" />
		<uint8 name="data" count="rh.recLen-6" />
	</struct>
	<struct name="DrawingGroupContainer">
		<type name="rh" type="RecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x040B" />
		</type>
		<type name="OfficeArtDgg" type="OfficeArtDggContainer" />
	</struct>
	<struct name="OfficeArtDggContainer">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0F000" />
		</type>
		<type name="drawingGroup" type="OfficeArtFDGGBlock" />
		<type name="blipStore" type="OfficeArtBStoreContainer" />
		<type name="drawingPrimaryOptions" type="OfficeArtFOPT" />
		<type name="drawingTertiaryOptions" type="OfficeArtTertiaryFOPT"
			optional="true" />
		<!--
			MS docs do not list drawingTertiaryOptions as optional
		-->
		<type name="colorMRU" type="OfficeArtColorMRUContainer" optional="true" />
		<!--
			MS docs do not list drawingTertiaryOptions as optional
		-->
		<type name="splitColors" type="OfficeArtSplitMenuColorContainer" />
	</struct>
	<struct name="OfficeArtFDGGBlock">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x0" />
			<limitation name="recType" value="0x0F006" />
		</type>
		<type name="head" type="OfficeArtFDGG">
			<!-- <limitation expression="cidcl==rh.recLen/8.0-2" /> FIX!-->
		</type>
		<type name="Rgidcl" type="OfficeArtIDCL" count="head.cidcl-1" />
	</struct>
	<struct name="OfficeArtFDGG">
		<uint32 name="spidMax">
			<limitation expression="&lt;67098623" />
		</uint32>
		<uint32 name="cidcl">
			<limitation expression="&lt;268435455" />
		</uint32>
		<uint32 name="cspSaved" />
		<uint32 name="cdgSaved" />
	</struct>
	<struct name="OfficeArtIDCL">
		<uint32 name="dgid" />
		<uint32 name="cspidCur" />
	</struct>
	<struct name="OfficeArtBStoreContainer">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0xF" />
			<limitation name="recType" value="0x0F001" />
		</type>
		<type name="rgfb" type="OfficeArtBStoreContainerFileBlock" count="rh.recInstance" />
	</struct>
	<struct name="OfficeArtFOPT">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0x3" />
			<limitation name="recType" value="0x0F00B" />
		</type>
		<type name="fopt" type="OfficeArtFOPTE" count="rh.recInstance" />
	</struct>
	<struct name="OfficeArtFOPTE">
		<type name="opid" type="OfficeArtFOPTEOPID" />
		<int32 name="op" />
		<uint8 name="complexData" count="(opid.fComplex)?op:0" />
	</struct>
	<struct name="OfficeArtFOPTEOPID">
		<uint14 name="opid" />
		<bit name="fBid" />
		<bit name="fComplex" />
	</struct>
	<struct name="OfficeArtTertiaryFOPT">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0x3" />
			<limitation name="recType" value="0x0F122" />
		</type>
		<type name="fopt" type="OfficeArtFOPTE" count="rh.recInstance" />
	</struct>
	<struct name="OfficeArtColorMRUContainer">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recType" value="0xF11A" />
			<limitation expression="recLen==4*recInstance" />
		</type>
		<type name="rgmsocr" type="MSOCR" count="rh.recInstance" />
	</struct>
	<struct name="MSOCR">
		<uint8 name="red" />
		<uint8 name="green" />
		<uint8 name="blue" />
		<uint3 name="unused1" />
		<bit name="fSchemeIndex" />
		<uint4 name="unused2" />
		<!--
			an addition limitation is needed that says that if fSchemeIndex ==1
			then green and blue must be 0
		-->
	</struct>
	<struct name="OfficeArtSplitMenuColorContainer">
		<type name="rh" type="OfficeArtRecordHeader">
			<limitation name="recVer" value="0x0" />
			<limitation name="recInstance" value="0x4" />
			<limitation name="recType" value="0xF11E" />
			<limitation name="recLen" value="0x10" />
		</type>
		<type name="smca" type="MSOCR" count="4" />
	</struct>

	<struct name="TODO">
		<!--
			a placeholder for structures that are not in the document
			specification yet
		-->
		<type name="rh" type="RecordHeader">
			<!--
				disallow structures that are implemented <limitation name="recType"
				value="!1000" />
			-->
		</type>
		<uint8 name="anon" count="rh.recLen" />
	</struct>
	<struct name="TODOS">
		<type name="anon" type="TODO" array="true" />
	</struct>
	<stream name="PowerPointDocument" key="PowerPoint Document"
		type="PowerPointStructs" />
	<stream name="CurrentUser" key="Current User" type="CurrentUserAtom" />
	<!--
		<stream name="Pictures" key="Pictures" type="OfficeArtBStoreDelay" />
	-->

</mso>
